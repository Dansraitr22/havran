<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ČSFD — Filmové recenze (classic)</title>
    <link rel="stylesheet" href="../../normalize.css">
    <link rel="stylesheet" href="./csfd.css">
    <meta name="robots" content="noindex">
</head>
<body>
    <table class="layout" align="center" cellpadding="8" cellspacing="0">
        <tr>
            <td colspan="3" class="banner">
                <img src="../images/čsfd.png " alt="ČSFD" class="logo">
                <div class="banner-text">Československá filmová databáze — Recenze & Novinky</div>
            </td>
        </tr>
        <tr>
            <td class="leftcol" width="200" valign="top">
                <div class="search">
                    <input type="text" placeholder="Hledat film..." class="search-input">
                    <button class="search-btn">Hledat</button>
                </div>
                <hr>
                <div class="menu">
                    <button class="nav-btn">Novinky</button>
                    <button class="nav-btn">Recenze</button>
                    <button class="nav-btn">Žebříčky</button>
                    <button class="nav-btn">Top 100</button>
                    <button class="nav-btn">Kontakt</button>
                </div>
            </td>
            <td class="centercol" valign="top">
                <marquee class="ticker">Nové recenze dnes: "Návštěva u sousedů" — 4/5 &#9733; | "Temné vody" — 3/5 &#9733;</marquee>

                <h2>Poslední recenze</h2>
                <div id="reviews">Načítání recenzí…</div>
            </td>
            <td class="rightcol" width="220" valign="top">
                <h4>Rychlé odkazy</h4>
                <ul class="quick-list">
                    <li><a href="#">Premiéry</a></li>
                    <li><a href="#">Festivaly</a></li>
                    <li><a href="#">Rozhovory</a></li>
                </ul>
                <hr>
                <div class="small-note">
                    <strong>Hlasování</strong>
                    <p>Hlasujte za film měsíce v pravém sloupci.</p>
                </div>
            </td>
        </tr>
        <tr>
            <td colspan="3" class="footer">&copy; 2002 ČSFD (fanpage) — Retro verze</td>
        </tr>
    </table>

    <script>
        // Load sample reviews from csfd.json and render
        function formatDate(d){ const dt=new Date(d); return dt.toLocaleDateString(); }
        fetch('./csfd.json')
            .then(r => r.json())
            .then(data => {
                const container = document.getElementById('reviews');
                if(!data || !data.length) { container.innerHTML = '<p>Žádné recenze.</p>'; return; }
                container.innerHTML = data.map(function(r){
                    return ''
                        + '<div class="review-item">'
                        + '<h3>' + r.title + ' <span class="rating">' + r.rating + '\u2605</span></h3>'
                        + '<div class="meta">' + formatDate(r.date) + ' \u2014 ' + r.author + '</div>'
                        + '<p>' + r.excerpt + '</p>'
                        + '<a href="#" class="read" data-id="' + r.id + '">Číst více</a>'
                        + '</div>';
                }).join('');

                document.querySelectorAll('.read').forEach(a => {
                    a.addEventListener('click', e => {
                        e.preventDefault();
                        const id = a.dataset.id;
                        const rev = data.find(x=>String(x.id)===String(id));
                        if(rev){
                                                        const win = window.open('', '_blank', 'width=700,height=600');
                                                        var popup = '<!doctype html>\n'
                                                            + '<html>\n'
                                                            + '<head>\n'
                                                            + '    <meta charset="utf-8">\n'
                                                            + '    <title>' + rev.title + '</title>\n'
                                                            + '    <link rel="stylesheet" href="../../normalize.css">\n'
                                                            + '    <link rel="stylesheet" href="./csfd.css">\n'
                                                            + '</head>\n'
                                                            + '<body style="font-family: Tahoma, Arial, Helvetica; padding:16px;">\n'
                                                            + '    <h1>' + rev.title + ' <small>' + rev.rating + '\u2605</small></h1>\n'
                                                            + '    <div class="meta">' + formatDate(rev.date) + ' \u2014 ' + rev.author + '</div>\n'
                                                            + '    <div>' + rev.content + '</div>\n'
                                                            + '</body>\n'
                                                            + '</html>';
                                                        try { win.document.open(); win.document.write(popup); } catch(e) { console.error('popup write failed', e); }
                                                        try { win.document.close(); } catch(e) { /* ignore */ }
                        }
                    });
                });
            })
            .catch(err => { document.getElementById('reviews').innerHTML = '<p>Chyba při načítání recenzí.</p>'; console.error(err); });
    </script>
</body>
</html>